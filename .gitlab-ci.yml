variables:
  OMP_NUM_THREADS: "1"


image: debian:bookworm

before_script:
  - apt-get update -qq && apt-get install -y -qq
  - apt-get install -y -qq make git gcc
  - apt-get install -y -qq libgtk-3-dev
  - apt-get install -y -qq libbart-dev

stages:
  - build
  - test

Build:
  stage: build
  script:
    - make all
  artifacts:
    paths:
      - view
      - cfl2png

Test_cfl2png:
  stage: test
  script:
    - apt-get update -qq && apt-get install -y -qq
    - apt-get install -y -qq bart
    - bart phantom pha.ra
    - ./view -h
    - ./cfl2png -x1 -u0.5 -CV pha.ra pha.png
  artifacts:
    paths:
      - pha.png
  needs: [Build]
  dependencies:
     - Build
